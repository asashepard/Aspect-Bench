id: stronger-password-policy
name: "Stronger password policy"
description: |
  ## Background
  The current password policy only requires a minimum length of 8 characters.
  This is insufficient for production security standards.
  
  ## Problem
  Weak passwords like "12345678" or "password" are currently accepted.
  This creates security vulnerabilities for user accounts.
  
  ## Task
  Implement a stronger password policy for:
  - User registration (`POST /users/signup`)
  - Password updates (`PATCH /users/me/password`)
  - Password reset (`POST /reset-password/`)
  - Admin user creation (`POST /users/`)
  
  Requirements:
  1. Minimum 8 characters (already exists)
  2. At least one uppercase letter
  3. At least one lowercase letter
  4. At least one digit
  5. At least one special character (!@#$%^&*()_+-=[]{}|;:,.<>?)
  
  Error messages should be clear about what's missing.
  
  ## Acceptance Criteria
  - Weak passwords are rejected with 422 status
  - Error message specifies which requirements are not met
  - Strong passwords are accepted
  - Existing valid passwords continue to work for login
  - All password-related endpoints enforce the policy

repo_path: ./backend
test_command: "pytest backend/tests/api/routes/test_aspect_bench_password_policy.py -v"
difficulty: medium
tags:
  - security
  - validation
  - users
  - password

baseline_prompt_hint: |
  Implement a stronger password policy requiring uppercase, lowercase, digits,
  and special characters. Apply to registration, password update, and reset endpoints.

aspect_prompt_hint: |
  Before making changes, read the Aspect Code KB files:
  - .aspect/deps.md - understand password validation dependencies
  - .aspect/flows.md - trace all password-related flows
  - .aspect/hotspots.md - identify security-critical code
  - .aspect/findings_top.md - check for existing security issues
  
  Use this knowledge to implement password validation consistently
  across all entry points without missing any.
